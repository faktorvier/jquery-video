/*! FAKTOR VIER Video Controller v0.1.2 | (c) 2015 FAKTOR VIER GmbH | http://faktorvier.ch */
function onYouTubeIframeAPIReady(){if("undefined"!=typeof $.video)for(callback_index in $.video.global.youtube_api_ready_callbacks)$.video.global.youtube_api_ready_callbacks[callback_index]()}var video_postmessage_event_func="attachEvent",video_postmessage_event="onmessage";window.addEventListener&&(video_postmessage_event_func="addEventListener",video_postmessage_event="message");
window[video_postmessage_event_func](video_postmessage_event,function(c){var e=c.origin,g=JSON.parse(c.data);c="undefined"==typeof g.event?null:g.event;if(!/^https?:\/\/player.vimeo.com/.test(e))return!1;e=$("#"+g.player_id);g=e.getVideoConfig();null==g&&(e.initVideo(),g=e.getVideoConfig());switch(c){case "ready":$.video.vimeo_postmessage(e,"addEventListener","play");$.video.vimeo_postmessage(e,"addEventListener","pause");$.video.vimeo_postmessage(e,"addEventListener","finish");e.data("video-player",
e);e.attr(g.attr_ready,"");e.trigger("ready"+$.video.global.event_suffix);break;case "play":e.removeAttr(g.attr_paused);e.attr(g.attr_playing,"");e.trigger("play"+$.video.global.event_suffix);break;case "pause":e.removeAttr(g.attr_playing);e.attr(g.attr_paused,"");e.trigger("pause"+$.video.global.event_suffix);break;case "finish":e.removeAttr(g.attr_playing),e.removeAttr(g.attr_paused),e.trigger("finish"+$.video.global.event_suffix)}},!1);
(function(c){c.video={global:{event_suffix:"_video",youtube_api_ready_callbacks:[],youtube_iframe_api:"https://www.youtube.com/iframe_api"},config:{attr_ready:"data-video-ready",attr_playing:"data-video-playing",attr_paused:"data-video-paused"}};var e=function(b,a){var d=b.data("video").config;if("undefined"==typeof b.data("video-player")){var f=function(){var f=new YT.Player(b[0],{events:{onReady:function(c){b.attr(d.attr_ready,"");a(c.target)},onStateChange:function(a){switch(a.data){case 0:b.removeAttr(d.attr_paused);
b.removeAttr(d.attr_playing);b.trigger("finish"+c.video.global.event_suffix);break;case 1:b.removeAttr(d.attr_paused);b.attr(d.attr_playing,"");b.trigger("play"+c.video.global.event_suffix);break;case 2:b.removeAttr(d.attr_playing),b.attr(d.attr_paused,""),b.trigger("pause"+c.video.global.event_suffix)}}}});b.data("video-player",f)};"undefined"==typeof YT||"undefined"==typeof YT.Player?(c.video.global.youtube_api_ready_callbacks.push(function(){f()}),0==c('script[src="https://www.youtube.com/iframe_api"]').length&&
0==c('script[src="http://www.youtube.com/iframe_api"]').length&&c("<script>\x3c/script>").attr("src",c.video.global.youtube_iframe_api).insertBefore(c("script").first())):f()}else a(b.data("video-player"))},g=function(b,a){"undefined"!=typeof b.data("video-player")&&a(b.data("video-player"))};c.video.vimeo_postmessage=function(b,a,c){a={method:a};c&&(a.value=c);"undefined"!=typeof b[0]&&b[0].contentWindow.postMessage(JSON.stringify(a),"*")};c.fn.getVideoConfig=function(){var b=c(this).first();return"undefined"!=
typeof b.data("video")?b.data("video").config:null};c.fn.getVideoPlayer=function(){var b=c(this).first();return"undefined"!=typeof b.data("video-player")?b.data("video-player"):null};c.fn.getVideoType=function(){var b=c(this).first();return video_type="video"==b.prop("tagName").toLowerCase()?"video":-1!==b.attr("src").indexOf("youtube.com/embed")?"youtube":-1!==b.attr("src").indexOf("player.vimeo.com/video")?"vimeo":"undefined"};c.fn.initVideo=function(b){return this.each(function(){var a=c(this),
d=a.getVideoType(),f=a.getVideoConfig();if(null==f)f=c.extend(c.extend({},c.video.config),b),a.data("video",{config:f});else return console.warn("Player already initialized!"),!1;if("youtube"==d)-1==a.attr("src").indexOf("enablejsapi=true")&&-1==a.attr("src").indexOf("enablejsapi=1")&&(-1==a.attr("src").indexOf("?")?a.attr("src",a.attr("src")+"?enablejsapi=1"):a.attr("src",a.attr("src")+"&enablejsapi=1"));else if("vimeo"==d&&(-1==a.attr("src").indexOf("api=true")&&-1==a.attr("src").indexOf("api=1")&&
(-1==a.attr("src").indexOf("?")?a.attr("src",a.attr("src")+"?api=1"):a.attr("src",a.attr("src")+"&api=1")),-1==a.attr("src").indexOf("player_id="))){var h=a.attr("id");"undefined"==typeof h&&(h="video-"+Math.round((new Date).getTime()+100*Math.random()),a.attr("id",h));-1==a.attr("src").indexOf("?")?a.attr("src",a.attr("src")+"?player_id="+h):a.attr("src",a.attr("src")+"&player_id="+h)}"video"==d?(4==a.get(0).readyState?(a.attr(f.attr_ready,""),a.trigger("ready"+c.video.global.event_suffix)):a.get(0).addEventListener("canplaythrough",
function(){a.attr(f.attr_ready,"");a.trigger("ready"+c.video.global.event_suffix);a.get(0).removeEventListener("canplaythrough",this)},!1),a.bind("play",function(){a.removeAttr(f.attr_paused);a.attr(f.attr_playing,"");a.trigger("play"+c.video.global.event_suffix)}),a.bind("pause",function(){a.removeAttr(f.attr_playing);a.attr(f.attr_paused,"");a.trigger("pause"+c.video.global.event_suffix)}),a.bind("ended",function(){a.removeAttr(f.attr_playing);a.removeAttr(f.attr_paused);a.trigger("finish"+c.video.global.event_suffix)}),
a.data("video-player",a[0])):"youtube"==d?e(a,function(b){a.trigger("ready"+c.video.global.event_suffix)}):"vimeo"==d&&g(a,function(b){a.trigger("ready"+c.video.global.event_suffix)})})};c.fn.playVideo=function(){return this.each(function(){var b=c(this),a=b.getVideoType(),d=b.getVideoPlayer();if(null==d)return console.warn("Player not initialized!"),!1;"video"==a?d.play():"youtube"==a?e(b,function(a){a.playVideo()}):"vimeo"==a&&g(b,function(a){c.video.vimeo_postmessage(a,"play")})})};c.fn.pauseVideo=
function(){return this.each(function(){var b=c(this),a=b.getVideoType(),d=b.getVideoPlayer();if(null==d)return console.warn("Player not initialized!"),!1;"video"==a?d.pause():"youtube"==a?e(b,function(a){a.pauseVideo()}):"vimeo"==a&&g(b,function(a){c.video.vimeo_postmessage(a,"pause")})})};c.fn.stopVideo=function(){return this.each(function(){var b=c(this),a=b.getVideoType(),d=b.getVideoPlayer();if(null==d)return console.warn("Player not initialized!"),!1;"video"==a?(d.pause(),d.currentTime=0):"youtube"==
a?e(b,function(a){a.seekTo(a.getDuration())}):"vimeo"==a&&g(b,function(a){c.video.vimeo_postmessage(a,"unload")})})};c.fn.restartVideo=function(){return this.each(function(){var b=c(this),a=b.getVideoType(),d=b.getVideoPlayer();b.getVideoConfig();if(null==d)return console.warn("Player not initialized!"),!1;"video"==a?(d.currentTime=0,d.play()):"youtube"==a?e(b,function(a){a.seekTo(0);a.playVideo();b.trigger("restart"+c.video.global.event_suffix)}):"vimeo"==a&&g(b,function(a){c.video.vimeo_postmessage(a,
"seekTo","0");c.video.vimeo_postmessage(a,"play");b.trigger("restart"+c.video.global.event_suffix)})})};c.fn.muteVideo=function(){return this.each(function(){var b=c(this),a=b.getVideoType(),d=b.getVideoPlayer();if(null==d)return console.warn("Player not initialized!"),!1;"video"==a?d.muted=!0:"youtube"==a?e(b,function(a){a.mute()}):"vimeo"==a&&g(b,function(a){c.video.vimeo_postmessage(a,"setVolume","0")})})};c.fn.unmuteVideo=function(){return this.each(function(){var b=c(this),a=b.getVideoType(),
d=b.getVideoPlayer();if(null==d)return console.warn("Player not initialized!"),!1;"video"==a?d.muted=!1:"youtube"==a?e(b,function(a){a.unMute()}):"vimeo"==a&&g(b,function(a){c.video.vimeo_postmessage(a,"setVolume",1)})})};c.fn.seekToVideo=function(b){return this.each(function(){var a=c(this),d=a.getVideoType(),f=a.getVideoPlayer();if(null==f)return console.warn("Player not initialized!"),!1;"video"==d?f.currentTime=b:"youtube"==d?e(a,function(a){a.seekTo(b)}):"vimeo"==d&&g(a,function(a){c.video.vimeo_postmessage(a,
"seekTo",b)})})};c.fn.destroyVideo=function(){return this.each(function(){var b=c(this);b.getVideoType();b.getVideoPlayer();var a=b.getVideoConfig();null!=a&&(b.removeData("video"),b.removeData("video-player"),b.removeAttr(a.attr_ready),b.removeAttr(a.attr_playing),b.removeAttr(a.attr_paused),b.trigger("destroy"+c.video.global.event_suffix))})};c.fn.addVideoEvent=function(b,a){return this.each(function(){var d=c(this),f=d.getVideoType(),e=d.getVideoPlayer();"play"!=b||"video"!=f||"undefined"==typeof d.get(0).paused||
d.get(0).paused||a(null,d,f,e);d.bind(b+c.video.global.event_suffix,function(b){a(b,d,f,e)})})};c.fn.removeVideoEvent=function(b){return this.each(function(){c(this).unbind(b+c.video.global.event_suffix)})};c.fn.video=function(b,a){var d="init",e={};"string"==typeof b?(d=b,e=a):e=b;return this.each(function(){var a=c(this);switch(d){case "init":a.initVideo(e);break;case "play":a.playVideo();break;case "pause":a.pauseVideo();break;case "stop":a.stopVideo();break;case "restart":a.restartVideo();break;
case "mute":a.muteVideo();break;case "unmute":a.unmuteVideo();break;case "seekTo":a.seekToVideo(e);break;case "destroy":a.destroyVideo();break;case "addEvent":a.addVideoEvent(e[0],e[1]);break;case "removeEvent":a.removeVideoEvent(e[0]);break;default:console.warn('Video action "'+d+'" not found')}})}})(jQuery);